<!DOCTYPE html>
<meta charset="utf-8">
<title>WebGL HUSL</title>

<style>[hidden]{display:none;}</style>

<h1>WebGL HUSL port alpha 1:</h1>

<div>
  <label for="c1r">lightness slider:</label>
  <input type="range" min=0 max=100 step=1 id="c1r" value=50>
  <input type="range" min=0 max=255 step=1 id="c1g" value=127 hidden>
  <input type="range" min=0 max=255 step=1 id="c1b" value=0 hidden>
</div>

<div hidden>
  <input type="range" min=0 max=255 step=1 id="c2r" value=0>
  <input type="range" min=0 max=255 step=1 id="c2g" value=127>
  <input type="range" min=0 max=255 step=1 id="c2b" value=255>
</div>

<div hidden>
  <label for="w">width:</label><input type="text" id="w" value=1500>
  <label for="h">height:</label><input type="text" id="h" value=300>
</div>

<div>
  <button id="makeimg">generate image</button>
</div>
<h1>Preview:</h1>
<canvas id="canvas" width="300" height="300"></canvas>
<h1>Downloadable image:</h1>
<img src="" alt="" id="img" download="gradient.png">




<script id="2d-vertex-shader" type="x-shader/x-vertex">

attribute vec2 a_position;
uniform vec2 u_resolution;

uniform vec3 u_color1;
uniform vec3 u_color2;

varying vec2 position;
varying vec2 pixelPosition;

varying vec3 color1;
varying vec3 color2;

void main() {

  position = (a_position+1.0)*0.5;
  pixelPosition = position*u_resolution;

  color1=u_color1;
  color2=u_color2;


  gl_Position = vec4(a_position,0,1);
}
</script>

<script id="2d-fragment-shader" type="x-shader/x-fragment">
precision highp float;

varying vec2 position;
varying vec2 pixelPosition;

varying vec3 color1;
varying vec3 color2;

uniform sampler2D huslLookupTable;


















float maxChromaForLH( float L, float H ){
    vec4 c = texture2D(huslLookupTable, vec2(H/512.0,L/512.0));
  return (c.r+c.g)*127.5;
}
float maxSafeChromaForL(float L){
  return texture2D(huslLookupTable, vec2(0.25,L/512.0)).b*127.5;
}

float fromLinear(float c) {
    float newC=0.0;
    if (c <= 0.0031308) {
      newC=12.92 * c;
    } else {
      newC=1.055 * pow(c, 1.0 / 2.4) - 0.055;
    }
    return newC;
}

float toLinear(float c) {
    float a = 0.055;
    float newC=0.0;
    if (c > 0.04045) {
        newC=pow((c + a) / (1.0 + a), 2.4);
    } else {
        newC=c / 12.92;
    }
    return newC;
}


vec4 xyz_to_rgb(vec4 tuple) {
    float R = fromLinear(dot(vec3(3.2409699419045214, -1.5373831775700935, -0.49861076029300328), tuple.rgb));
    float G = fromLinear(dot(vec3(-0.96924363628087983, 1.8759675015077207, 0.041555057407175613), tuple.rgb));
    float B = fromLinear(dot(vec3(0.055630079696993609, -0.20397695888897657, 1.0569715142428786), tuple.rgb));
    return vec4(R, G, B, tuple.a);
}


vec4 rgb_to_xyz(vec4 tuple) {
    float R = tuple.r;
    float G = tuple.g;
    float B = tuple.b;
    vec3 rgbl = vec3(toLinear(R),toLinear(G),toLinear(B));
    float X = dot(vec3(0.41239079926595948, 0.35758433938387796, 0.18048078840183429),rgbl);
    float Y = dot(vec3(0.21263900587151036, 0.71516867876775593, 0.072192315360733715),rgbl);
    float Z = dot(vec3(0.019330818715591851, 0.11919477979462599, 0.95053215224966058),rgbl);
    return vec4(X,Y,Z,tuple.a);
}


float Y_to_L(float Y){
    float L=0.0;
    if (Y <= 0.0088564516790356308) {
      L= Y * 903.2962962962963;
    } else {
      L= 116.0 * pow(Y, 1.0 / 3.0) - 16.0;
    }
    return L;
}


float L_to_Y(float L) {
    float Y=0.0;
    if (L <= 8.0) {
      Y= L / 903.2962962962963;
    } else {
      Y= pow((L + 16.0) / 116.0, 3.0);
    }
    return Y;
}


vec4 xyz_to_luv(vec4 tuple){
    float X = tuple.r;
    float Y = tuple.g;
    float Z = tuple.b;
    float L = Y_to_L(Y);
    float varU = (4.0 * X) / (X + (15.0 * Y) + (3.0 * Z));
    float varV = (9.0 * Y) / (X + (15.0 * Y) + (3.0 * Z));
    float U = 13.0 * L * (varU - 0.19783000664283681);
    float V = 13.0 * L * (varV - 0.468319994938791);
    return vec4(L, U, V, tuple.a);
}



vec4 luv_to_xyz(vec4 tuple) {

    float L = tuple.r;
    float U = tuple.g;
    float V = tuple.b;

    //if (L === 0) {
    //  return [0, 0, 0];
    //}
    float varU = U / (13.0 * L) + 0.19783000664283681;
    float varV = V / (13.0 * L) + 0.468319994938791;
    float Y = L_to_Y(L);
    float X = 0.0 - (9.0 * Y * varU) / ((varU - 4.0) * varV - varU * varV);
    float Z = (9.0 * Y - (15.0 * varV * Y) - (varV * X)) / (3.0 * varV);
    return vec4(X, Y, Z,tuple.a);
}




vec4 luv_to_lch(vec4 tuple) {

    float L = tuple.r;
    float U = tuple.g;
    float V = tuple.b;

    float C = sqrt(pow(U, 2.0) + pow(V, 2.0));
    float H = degrees(atan(V, U));
    if (H < 0.0) {
        H = 360.0 + H;
    }
    
    return vec4(L, C, H, tuple.a);
}





vec4 lch_to_luv(vec4 color) {
    float a = cos(radians(color.b)) * color.g;
    float b = sin(radians(color.b)) * color.g;

    return vec4(color.r, a, b, color.a);
}


vec4 husl_to_lch(vec4 tuple) {
    float H = tuple.r;
    float S = tuple.g;
    float L = tuple.b;

    float C = maxChromaForLH(L, H) / 100.0 * S;

    return vec4(L, C, H, tuple.a);
}

vec4 lch_to_husl(vec4 tuple) {
    float L = tuple.r;
    float C = tuple.g;
    float H = tuple.b;

    float S = C / maxChromaForLH(L, H) * 100.0;

    return vec4(H, S, L, tuple.a);
}

vec4 huslp_to_lch(vec4 tuple) {

    float H = tuple.r;
    float S = tuple.g;
    float L = tuple.b;


    float C = maxSafeChromaForL(L) / 100.0 * S;

    return vec4(L, C, H, tuple.a);
}

vec4 lch_to_huslp(vec4 tuple) {

    float L = tuple.r;
    float C = tuple.g;
    float H = tuple.b;

    float S = C / maxSafeChromaForL(L) * 100.0;
    
    return vec4(H, S, L, tuple.a);
  }




vec4 lch_to_rgb(vec4 color) {
    vec4 luv = lch_to_luv(color);
    vec4 xyz = luv_to_xyz(luv);
    vec4 rgb = xyz_to_rgb(xyz);

    return rgb;
}



































vec3 dithering( vec2 pixelPosition ){
  vec3 vDither = vec3( dot( vec2( 171.0, 231.0 ), pixelPosition.xy  ) );
  return fract( vDither.rgb / vec3( 103.0, 71.0, 97.0 ) ) / 255.0;
}





void main() {
  vec3 gradient = mix( pow(color1,vec3(2.2)), pow(color2,vec3(2.2)), position.x );
  vec3 outcol = gradient + dithering( pixelPosition );


  float lightness = color1.r*255.0;
  float hue = position.x*360.0;
  float chroma = position.y*maxChromaForLH(lightness,hue);
  //float chroma = position.y*maxSafeChromaForL(lightness);


  gl_FragColor = pow(vec4( outcol, 1.0 ),vec4(1.0/2.2));
  gl_FragColor = lch_to_rgb(vec4(lightness,chroma,hue,1.0));
  //gl_FragColor = texture2D(huslLookupTable, vec2(position.x,1.0-position.y));

}
</script>


<script>
"use strict";


var huslMaxChromaImage=document.createElement("img")

huslMaxChromaImage.src="data:image/png;base64,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"

function createShaderFromScript(gl, scriptId) {
  var shaderType;
  var shaderScript = document.getElementById(scriptId);

  var shaderSource = shaderScript.text;


  if (shaderScript.type === "x-shader/x-vertex") {
    shaderType = gl.VERTEX_SHADER;
  } else if (shaderScript.type === "x-shader/x-fragment") {
    shaderType = gl.FRAGMENT_SHADER;
  }

  var shader = gl.createShader(shaderType);
  gl.shaderSource(shader, shaderSource);
  gl.compileShader(shader);

  return shader;
}


function createProgramFromScripts(gl, vertexShader, fragmentShader) {


  var program = gl.createProgram();

  gl.attachShader(program, createShaderFromScript(gl, vertexShader  ) );
  gl.attachShader(program, createShaderFromScript(gl, fragmentShader) );

  gl.linkProgram(program);

  return program;
};


huslMaxChromaImage.onload=function(){


  var canvas = document.getElementById("canvas");

  var gl = canvas.getContext("webgl",{preserveDrawingBuffer: true});


  var program = createProgramFromScripts(gl, "2d-vertex-shader", "2d-fragment-shader" );
  gl.useProgram(program);

  // position
  var positionLocation = gl.getAttribLocation(program, "a_position");

  // resolution
  var resolutionLocation = gl.getUniformLocation(program, "u_resolution");
  gl.uniform2f(resolutionLocation, canvas.width, canvas.height);

  // color1
  var c1Location = gl.getUniformLocation(program, "u_color1");
  gl.uniform3f(c1Location , 0.5, 0.5,0.5);

  // color2
  var c2Location = gl.getUniformLocation(program, "u_color2");
  gl.uniform3f(c2Location, 0.5, 0.5,0.5);


  var buffer = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
        -1.0, -1.0,
         1.0, -1.0,
        -1.0,  1.0,
        -1.0,  1.0,
         1.0, -1.0,
         1.0,  1.0]), gl.STATIC_DRAW);
  gl.enableVertexAttribArray(positionLocation);
  gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);






  var texture = gl.createTexture();
  gl.bindTexture(gl.TEXTURE_2D, texture);
 
  // Set the parameters so we can render any size image.
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
 
  // Upload the image into the texture.
  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, huslMaxChromaImage);








  gl.drawArrays(gl.TRIANGLES, 0, 6);

  var update=function(){
    gl.uniform3f(c1Location , 
      document.getElementById("c1r").value/255,
      document.getElementById("c1g").value/255,
      document.getElementById("c1b").value/255);
    gl.uniform3f(c2Location , 
      document.getElementById("c2r").value/255,
      document.getElementById("c2g").value/255,
      document.getElementById("c2b").value/255);
    gl.drawArrays(gl.TRIANGLES, 0, 6);
  }


  document.getElementById("c1r").oninput=update
  document.getElementById("c1g").oninput=update
  document.getElementById("c1b").oninput=update

  document.getElementById("c2r").oninput=update
  document.getElementById("c2g").oninput=update
  document.getElementById("c2b").oninput=update

  update();

  document.getElementById("makeimg").onclick=function(){
    console.time("createImage")
    document.getElementById("img").src=canvas.toDataURL()
    console.timeEnd("createImage")
  }

}







</script>

